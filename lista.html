<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chá de Casa Nova</title>
</head>
<body>
    <h1>Lista de Presentes</h1>
    <ul id="listaPresentes"></ul>

    <form id="formPresente">
        <label for="item">Item:</label>
        <input type="text" id="item" name="item" required><br><br>
        <label for="comodo">Cômodo:</label>
        <input type="text" id="comodo" name="comodo" required><br><br>
        <label for="presenteador">Seu Nome:</label>
        <input type="text" id="presenteador" name="presenteador" required><br><br>
        <button type="submit">Reservar Presente</button>
    </form>

    <script>
        // Carregar lista de presentes
        function carregarPresentes() {
            fetch('https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?action=read')
                .then(response => response.json())
                .then(data => {
                    const lista = document.getElementById('listaPresentes');
                    lista.innerHTML = '';
                    data.forEach(item => {
                        if (item.disponivel === 'sim') {
                            const li = document.createElement('li');
                            li.textContent = `Item: ${item.item}, Cômodo: ${item.comodo}`;
                            lista.appendChild(li);
                        }
                    });
                });
        }

        // Adicionar evento ao formulário
        document.getElementById('formPresente').addEventListener('submit', function(event) {
            event.preventDefault();
            const item = document.getElementById('item').value;
            const comodo = document.getElementById('comodo').value;
            const presenteador = document.getElementById('presenteador').value;

            fetch('https://script.google.com/macros/s/AKfycbwKccyOJYsJnPSn90J7GCvy0XABnu9z8u9xoZkwnbz_h8mOc-SrQ0bLREnsEqXTdhta/exec', {
                method: 'POST',
                body: JSON.stringify({ item, comodo, presenteador, action: 'reserve' }),
                headers: { 'Content-Type': 'application/json' }
            }).then(response => response.json())
              .then(data => {
                  alert('Presente reservado com sucesso!');
                  carregarPresentes();
                  document.getElementById('formPresente').reset();
              }).catch(error => {
                  console.error('Erro:', error);
              });
        });

        // Carregar presentes ao iniciar
        carregarPresentes();
    </script>
</body>
</html>